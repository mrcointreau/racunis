<!DOCTYPE html><html class="default" lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>@racunis/postgresql - v1.0.0 | Racunis</title><meta name="description" content="Documentation for Racunis"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="../assets/style.css"/><link rel="stylesheet" href="../assets/highlight.css"/><link rel="stylesheet" href="../assets/custom.css"/><script defer src="../assets/main.js"></script><script async src="../assets/icons.js" id="tsd-icons-script"></script><script async src="../assets/search.js" id="tsd-search-script"></script><script async src="../assets/navigation.js" id="tsd-nav-script"></script><link rel="icon" href="../favicon.svg" />
</head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><div class="table-cell" id="tsd-search" data-base=".."><div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><use href="../assets/icons.svg#icon-search"></use></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div><div class="field"><div id="tsd-toolbar-links"></div></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="../index.html" class="title">Racunis</a></div><div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><use href="../assets/icons.svg#icon-menu"></use></svg></a></div></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><ul class="tsd-breadcrumb"><li><a href="../index.html">Racunis</a></li><li><a href="_racunis_postgresql.html">@racunis/postgresql</a></li></ul><h1>Module @racunis/postgresql - v1.0.0</h1></div><section class="tsd-panel tsd-typography"><p align='center'>
  <img src='https://github.com/mrcointreau/racunis/raw/main/assets/logo.svg' alt='Racunis Logo' width='200' height='200'>
</p>

<a id="md:racunispostgresql" class="tsd-anchor"></a><h1><a href="#md:racunispostgresql">@racunis/postgresql</a></h1><p><code>@racunis/postgresql</code> is a TypeScript-based, robust, and flexible job queueing system designed for PostgreSQL databases. It facilitates easy management of background tasks in Node.js applications using PostgreSQL. The system abstracts the complexities of database operations and job processing, offering a straightforward and powerful API for job queueing and processing.</p>
<a id="md:features" class="tsd-anchor"></a><h2><a href="#md:features">Features</a></h2><ul>
<li>PostgreSQL-specific implementations of core abstractions.</li>
<li>Type definitions for jobs and events.</li>
<li>Easy to extend and integrate into existing applications.</li>
<li>Configurable options for queues and workers.</li>
<li>Support for handling multiple job types within a worker.</li>
<li>Event handling for job states and errors.</li>
</ul>
<p>To install <code>@racunis/postgresql</code>, use one of the following commands:</p>
<pre><code class="language-bash"><span class="hl-0"># npm</span><br/><span class="hl-1">npm</span><span class="hl-2"> </span><span class="hl-3">install</span><span class="hl-2"> </span><span class="hl-3">@racunis/postgresql</span><br/><br/><span class="hl-0"># yarn</span><br/><span class="hl-1">yarn</span><span class="hl-2"> </span><span class="hl-3">add</span><span class="hl-2"> </span><span class="hl-3">@racunis/postgresql</span><br/><br/><span class="hl-0"># pnpm</span><br/><span class="hl-1">pnpm</span><span class="hl-2"> </span><span class="hl-3">add</span><span class="hl-2"> </span><span class="hl-3">@racunis/postgresql</span><br/><br/><span class="hl-0"># bun</span><br/><span class="hl-1">bun</span><span class="hl-2"> </span><span class="hl-3">add</span><span class="hl-2"> </span><span class="hl-3">@racunis/postgresql</span>
</code><button>Copy</button></pre>
<a id="md:usage" class="tsd-anchor"></a><h2><a href="#md:usage">Usage</a></h2><a id="md:example" class="tsd-anchor"></a><h3><a href="#md:example">Example</a></h3><p>Here is a complete example of how to use <code>@racunis/postgresql</code> to manage a job queue and worker with PostgreSQL.</p>
<pre><code class="language-typescript"><span class="hl-4">import</span><span class="hl-2"> { </span><span class="hl-5">PostgreSqlQueue</span><span class="hl-2">, </span><span class="hl-5">PostgreSqlWorker</span><span class="hl-2"> } </span><span class="hl-4">from</span><span class="hl-2"> </span><span class="hl-3">&#39;@racunis/postgresql&#39;</span><br/><br/><span class="hl-6">interface</span><span class="hl-2"> </span><span class="hl-7">JobPayload</span><span class="hl-2"> {</span><br/><span class="hl-2">  </span><span class="hl-5">task</span><span class="hl-2">: </span><span class="hl-7">string</span><br/><span class="hl-2">}</span><br/><br/><span class="hl-6">const</span><span class="hl-2"> </span><span class="hl-1">main</span><span class="hl-2"> = </span><span class="hl-6">async</span><span class="hl-2"> () </span><span class="hl-6">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">  </span><span class="hl-0">// Create the queue</span><br/><span class="hl-2">  </span><span class="hl-6">const</span><span class="hl-2"> </span><span class="hl-8">queue</span><span class="hl-2"> = </span><span class="hl-4">await</span><span class="hl-2"> </span><span class="hl-5">PostgreSqlQueue</span><span class="hl-2">.</span><span class="hl-1">create</span><span class="hl-2">&lt;</span><span class="hl-7">JobPayload</span><span class="hl-2">&gt;(</span><span class="hl-3">&#39;Queue&#39;</span><span class="hl-2">, {</span><br/><span class="hl-2">    </span><span class="hl-5">connectionString:</span><span class="hl-2"> </span><span class="hl-3">&#39;postgresql://user:password@localhost:port/db&#39;</span><span class="hl-2">,</span><br/><span class="hl-2">  })</span><br/><br/><span class="hl-2">  </span><span class="hl-0">// Add a job to the queue</span><br/><span class="hl-2">  </span><span class="hl-4">await</span><span class="hl-2"> </span><span class="hl-5">queue</span><span class="hl-2">.</span><span class="hl-1">add</span><span class="hl-2">({ </span><span class="hl-5">task:</span><span class="hl-2"> </span><span class="hl-3">&#39;processData&#39;</span><span class="hl-2"> }, </span><span class="hl-9">10</span><span class="hl-2">)</span><br/><br/><span class="hl-2">  </span><span class="hl-0">// Create a worker to process jobs from the queue</span><br/><span class="hl-2">  </span><span class="hl-6">const</span><span class="hl-2"> </span><span class="hl-8">worker</span><span class="hl-2"> = </span><span class="hl-5">PostgreSqlWorker</span><span class="hl-2">.</span><span class="hl-1">create</span><span class="hl-2">(</span><span class="hl-5">queue</span><span class="hl-2">, (</span><span class="hl-5">job</span><span class="hl-2">) </span><span class="hl-6">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">    </span><span class="hl-5">console</span><span class="hl-2">.</span><span class="hl-1">log</span><span class="hl-2">(</span><span class="hl-3">&#39;Processing job:&#39;</span><span class="hl-2">, </span><span class="hl-5">job</span><span class="hl-2">.</span><span class="hl-5">payload</span><span class="hl-2">.</span><span class="hl-5">task</span><span class="hl-2">)</span><br/><span class="hl-2">  })</span><br/><span class="hl-2">}</span><br/><br/><span class="hl-4">try</span><span class="hl-2"> {</span><br/><span class="hl-2">  </span><span class="hl-4">await</span><span class="hl-2"> </span><span class="hl-1">main</span><span class="hl-2">()</span><br/><span class="hl-2">}</span><br/><span class="hl-4">catch</span><span class="hl-2"> (</span><span class="hl-5">error</span><span class="hl-2">) {</span><br/><span class="hl-2">  </span><span class="hl-5">console</span><span class="hl-2">.</span><span class="hl-1">error</span><span class="hl-2">(</span><span class="hl-5">error</span><span class="hl-2">)</span><br/><span class="hl-2">}</span>
</code><button>Copy</button></pre>
<a id="md:handling-multiple-job-types" class="tsd-anchor"></a><h3><a href="#md:handling-multiple-job-types">Handling Multiple Job Types</a></h3><p>To handle different job types within a worker, you can use a switch statement to process each job type accordingly.</p>
<pre><code class="language-typescript"><span class="hl-4">import</span><span class="hl-2"> { </span><span class="hl-5">PostgreSqlQueue</span><span class="hl-2">, </span><span class="hl-5">PostgreSqlWorker</span><span class="hl-2"> } </span><span class="hl-4">from</span><span class="hl-2"> </span><span class="hl-3">&#39;@racunis/postgresql&#39;</span><br/><span class="hl-4">import</span><span class="hl-2"> </span><span class="hl-4">type</span><span class="hl-2"> { </span><span class="hl-5">Job</span><span class="hl-2"> } </span><span class="hl-4">from</span><span class="hl-2"> </span><span class="hl-3">&#39;@racunis/core&#39;</span><br/><br/><span class="hl-0">// Define job payload interfaces for different job types</span><br/><span class="hl-4">export</span><span class="hl-2"> </span><span class="hl-6">interface</span><span class="hl-2"> </span><span class="hl-7">EmailProcessingJobPayload</span><span class="hl-2"> {</span><br/><span class="hl-2">  </span><span class="hl-5">type</span><span class="hl-2">: </span><span class="hl-3">&#39;EmailProcessing&#39;</span><br/><span class="hl-2">  </span><span class="hl-5">details</span><span class="hl-2">: {</span><br/><span class="hl-2">    </span><span class="hl-5">recipient</span><span class="hl-2">: </span><span class="hl-7">string</span><br/><span class="hl-2">    </span><span class="hl-5">content</span><span class="hl-2">: </span><span class="hl-7">string</span><br/><span class="hl-2">  }</span><br/><span class="hl-2">}</span><br/><br/><span class="hl-4">export</span><span class="hl-2"> </span><span class="hl-6">interface</span><span class="hl-2"> </span><span class="hl-7">DataMigrationJobPayload</span><span class="hl-2"> {</span><br/><span class="hl-2">  </span><span class="hl-5">type</span><span class="hl-2">: </span><span class="hl-3">&#39;DataMigration&#39;</span><br/><span class="hl-2">  </span><span class="hl-5">details</span><span class="hl-2">: {</span><br/><span class="hl-2">    </span><span class="hl-5">source</span><span class="hl-2">: </span><span class="hl-7">string</span><br/><span class="hl-2">    </span><span class="hl-5">destination</span><span class="hl-2">: </span><span class="hl-7">string</span><br/><span class="hl-2">  }</span><br/><span class="hl-2">}</span><br/><br/><span class="hl-4">export</span><span class="hl-2"> </span><span class="hl-6">interface</span><span class="hl-2"> </span><span class="hl-7">ReportGenerationJobPayload</span><span class="hl-2"> {</span><br/><span class="hl-2">  </span><span class="hl-5">type</span><span class="hl-2">: </span><span class="hl-3">&#39;ReportGeneration&#39;</span><br/><span class="hl-2">  </span><span class="hl-5">details</span><span class="hl-2">: {</span><br/><span class="hl-2">    </span><span class="hl-5">reportId</span><span class="hl-2">: </span><span class="hl-7">string</span><br/><span class="hl-2">    </span><span class="hl-5">requestedBy</span><span class="hl-2">: </span><span class="hl-7">string</span><br/><span class="hl-2">  }</span><br/><span class="hl-2">}</span><br/><br/><span class="hl-0">// Union type for job payloads</span><br/><span class="hl-4">export</span><span class="hl-2"> </span><span class="hl-6">type</span><span class="hl-2"> </span><span class="hl-7">JobPayload</span><span class="hl-2"> = </span><span class="hl-7">EmailProcessingJobPayload</span><span class="hl-2"> | </span><span class="hl-7">DataMigrationJobPayload</span><span class="hl-2"> | </span><span class="hl-7">ReportGenerationJobPayload</span><br/><br/><span class="hl-6">const</span><span class="hl-2"> </span><span class="hl-1">main</span><span class="hl-2"> = </span><span class="hl-6">async</span><span class="hl-2"> () </span><span class="hl-6">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">  </span><span class="hl-0">// Create the queue</span><br/><span class="hl-2">  </span><span class="hl-6">const</span><span class="hl-2"> </span><span class="hl-8">queue</span><span class="hl-2"> = </span><span class="hl-4">await</span><span class="hl-2"> </span><span class="hl-5">PostgreSqlQueue</span><span class="hl-2">.</span><span class="hl-1">create</span><span class="hl-2">&lt;</span><span class="hl-7">JobPayload</span><span class="hl-2">&gt;(</span><span class="hl-3">&#39;Queue&#39;</span><span class="hl-2">, {</span><br/><span class="hl-2">    </span><span class="hl-5">connectionString:</span><span class="hl-2"> </span><span class="hl-3">&#39;postgresql://user:password@localhost:port/db&#39;</span><span class="hl-2">,</span><br/><span class="hl-2">  })</span><br/><br/><span class="hl-2">  </span><span class="hl-0">// Add jobs to the queue</span><br/><span class="hl-2">  </span><span class="hl-4">await</span><span class="hl-2"> </span><span class="hl-5">queue</span><span class="hl-2">.</span><span class="hl-1">add</span><span class="hl-2">({ </span><span class="hl-5">type:</span><span class="hl-2"> </span><span class="hl-3">&#39;EmailProcessing&#39;</span><span class="hl-2">, </span><span class="hl-5">details:</span><span class="hl-2"> { </span><span class="hl-5">recipient:</span><span class="hl-2"> </span><span class="hl-3">&#39;user@example.com&#39;</span><span class="hl-2">, </span><span class="hl-5">content:</span><span class="hl-2"> </span><span class="hl-3">&#39;Hello, World!&#39;</span><span class="hl-2"> } }, </span><span class="hl-9">5</span><span class="hl-2">)</span><br/><span class="hl-2">  </span><span class="hl-4">await</span><span class="hl-2"> </span><span class="hl-5">queue</span><span class="hl-2">.</span><span class="hl-1">add</span><span class="hl-2">({ </span><span class="hl-5">type:</span><span class="hl-2"> </span><span class="hl-3">&#39;DataMigration&#39;</span><span class="hl-2">, </span><span class="hl-5">details:</span><span class="hl-2"> { </span><span class="hl-5">source:</span><span class="hl-2"> </span><span class="hl-3">&#39;System A&#39;</span><span class="hl-2">, </span><span class="hl-5">destination:</span><span class="hl-2"> </span><span class="hl-3">&#39;System B&#39;</span><span class="hl-2"> } }, </span><span class="hl-9">3</span><span class="hl-2">)</span><br/><span class="hl-2">  </span><span class="hl-4">await</span><span class="hl-2"> </span><span class="hl-5">queue</span><span class="hl-2">.</span><span class="hl-1">add</span><span class="hl-2">({ </span><span class="hl-5">type:</span><span class="hl-2"> </span><span class="hl-3">&#39;ReportGeneration&#39;</span><span class="hl-2">, </span><span class="hl-5">details:</span><span class="hl-2"> { </span><span class="hl-5">reportId:</span><span class="hl-2"> </span><span class="hl-3">&#39;R123&#39;</span><span class="hl-2">, </span><span class="hl-5">requestedBy:</span><span class="hl-2"> </span><span class="hl-3">&#39;admin&#39;</span><span class="hl-2"> } }, </span><span class="hl-9">4</span><span class="hl-2">)</span><br/><br/><span class="hl-2">  </span><span class="hl-0">// Create a worker to process jobs from the queue</span><br/><span class="hl-2">  </span><span class="hl-6">const</span><span class="hl-2"> </span><span class="hl-8">worker</span><span class="hl-2"> = </span><span class="hl-5">PostgreSqlWorker</span><span class="hl-2">.</span><span class="hl-1">create</span><span class="hl-2">(</span><span class="hl-5">queue</span><span class="hl-2">, (</span><span class="hl-5">job</span><span class="hl-2">) </span><span class="hl-6">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">    </span><span class="hl-6">const</span><span class="hl-2"> { </span><span class="hl-8">type</span><span class="hl-2">, </span><span class="hl-8">details</span><span class="hl-2"> } = </span><span class="hl-5">job</span><span class="hl-2">.</span><span class="hl-5">payload</span><br/><span class="hl-2">    </span><span class="hl-4">switch</span><span class="hl-2"> (</span><span class="hl-5">type</span><span class="hl-2">) {</span><br/><span class="hl-2">      </span><span class="hl-4">case</span><span class="hl-2"> </span><span class="hl-3">&#39;EmailProcessing&#39;</span><span class="hl-2">:</span><br/><span class="hl-2">        </span><span class="hl-5">console</span><span class="hl-2">.</span><span class="hl-1">log</span><span class="hl-2">(</span><span class="hl-3">`Processing Email Job: Recipient - </span><span class="hl-6">${</span><span class="hl-5">details</span><span class="hl-10">.</span><span class="hl-5">recipient</span><span class="hl-6">}</span><span class="hl-3">, Content - </span><span class="hl-6">${</span><span class="hl-5">details</span><span class="hl-10">.</span><span class="hl-5">content</span><span class="hl-6">}</span><span class="hl-3">`</span><span class="hl-2">)</span><br/><span class="hl-2">        </span><span class="hl-4">break</span><br/><span class="hl-2">      </span><span class="hl-4">case</span><span class="hl-2"> </span><span class="hl-3">&#39;DataMigration&#39;</span><span class="hl-2">:</span><br/><span class="hl-2">        </span><span class="hl-5">console</span><span class="hl-2">.</span><span class="hl-1">log</span><span class="hl-2">(</span><span class="hl-3">`Processing Data Migration Job: Source - </span><span class="hl-6">${</span><span class="hl-5">details</span><span class="hl-10">.</span><span class="hl-5">source</span><span class="hl-6">}</span><span class="hl-3">, Destination - </span><span class="hl-6">${</span><span class="hl-5">details</span><span class="hl-10">.</span><span class="hl-5">destination</span><span class="hl-6">}</span><span class="hl-3">`</span><span class="hl-2">)</span><br/><span class="hl-2">        </span><span class="hl-4">break</span><br/><span class="hl-2">      </span><span class="hl-4">case</span><span class="hl-2"> </span><span class="hl-3">&#39;ReportGeneration&#39;</span><span class="hl-2">:</span><br/><span class="hl-2">        </span><span class="hl-5">console</span><span class="hl-2">.</span><span class="hl-1">log</span><span class="hl-2">(</span><span class="hl-3">`Processing Report Generation Job: Report ID - </span><span class="hl-6">${</span><span class="hl-5">details</span><span class="hl-10">.</span><span class="hl-5">reportId</span><span class="hl-6">}</span><span class="hl-3">, Requested By - </span><span class="hl-6">${</span><span class="hl-5">details</span><span class="hl-10">.</span><span class="hl-5">requestedBy</span><span class="hl-6">}</span><span class="hl-3">`</span><span class="hl-2">)</span><br/><span class="hl-2">        </span><span class="hl-4">break</span><br/><span class="hl-2">    }</span><br/><span class="hl-2">  })</span><br/><span class="hl-2">}</span><br/><br/><span class="hl-4">try</span><span class="hl-2"> {</span><br/><span class="hl-2">  </span><span class="hl-4">await</span><span class="hl-2"> </span><span class="hl-1">main</span><span class="hl-2">()</span><br/><span class="hl-2">}</span><br/><span class="hl-4">catch</span><span class="hl-2"> (</span><span class="hl-5">error</span><span class="hl-2">) {</span><br/><span class="hl-2">  </span><span class="hl-5">console</span><span class="hl-2">.</span><span class="hl-1">error</span><span class="hl-2">(</span><span class="hl-5">error</span><span class="hl-2">)</span><br/><span class="hl-2">}</span>
</code><button>Copy</button></pre>
<a id="md:queue-and-worker-options" class="tsd-anchor"></a><h2><a href="#md:queue-and-worker-options">Queue and Worker Options</a></h2><p><code>@racunis/postgresql</code> provides configurable options for queues and workers to customize their behavior.</p>
<a id="md:queue-options" class="tsd-anchor"></a><h3><a href="#md:queue-options">Queue Options</a></h3><ul>
<li><p><strong><code>autostart</code></strong>: Automatically start processing jobs when the queue is created. Default is <code>true</code>.</p>
<pre><code class="language-typescript"><span class="hl-6">const</span><span class="hl-2"> </span><span class="hl-8">queue</span><span class="hl-2"> = </span><span class="hl-4">await</span><span class="hl-2"> </span><span class="hl-5">PostgreSqlQueue</span><span class="hl-2">.</span><span class="hl-1">create</span><span class="hl-2">&lt;</span><span class="hl-7">JobPayload</span><span class="hl-2">&gt;(</span><span class="hl-3">&#39;Queue&#39;</span><span class="hl-2">, {</span><br/><span class="hl-2">  </span><span class="hl-5">connectionString:</span><span class="hl-2"> </span><span class="hl-3">&#39;postgresql://user:password@localhost:port/db&#39;</span><span class="hl-2">,</span><br/><span class="hl-2">}, {</span><br/><span class="hl-2">  </span><span class="hl-5">autostart:</span><span class="hl-2"> </span><span class="hl-6">false</span><span class="hl-2">, </span><span class="hl-0">// Do not start automatically</span><br/><span class="hl-2">})</span>
</code><button>Copy</button></pre>
</li>
</ul>
<a id="md:worker-options" class="tsd-anchor"></a><h3><a href="#md:worker-options">Worker Options</a></h3><ul>
<li><p><strong><code>autostart</code></strong>: Automatically start the worker when it is created. Default is <code>true</code>.</p>
</li>
<li><p><strong><code>processingInterval</code></strong>: Interval in milliseconds between job processing attempts. Default is <code>0</code>.</p>
</li>
<li><p><strong><code>waitingInterval</code></strong>: Interval in milliseconds for checking new jobs when the worker is waiting. Default is <code>1000</code>.</p>
</li>
<li><p><strong><code>maxRetries</code></strong>: Maximum number of retries for processing a job. Default is <code>3</code>.</p>
</li>
<li><p><strong><code>retryInterval</code></strong>: Interval in milliseconds between retry attempts. Default is <code>500</code>.</p>
<pre><code class="language-typescript"><span class="hl-6">const</span><span class="hl-2"> </span><span class="hl-8">worker</span><span class="hl-2"> = </span><span class="hl-5">PostgreSqlWorker</span><span class="hl-2">.</span><span class="hl-1">create</span><span class="hl-2">&lt;</span><span class="hl-7">JobPayload</span><span class="hl-2">&gt;(</span><span class="hl-5">queue</span><span class="hl-2">, (</span><span class="hl-5">job</span><span class="hl-2">) </span><span class="hl-6">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">  </span><span class="hl-5">console</span><span class="hl-2">.</span><span class="hl-1">log</span><span class="hl-2">(</span><span class="hl-3">&#39;Processing job:&#39;</span><span class="hl-2">, </span><span class="hl-5">job</span><span class="hl-2">.</span><span class="hl-5">payload</span><span class="hl-2">.</span><span class="hl-5">task</span><span class="hl-2">)</span><br/><span class="hl-2">}, {</span><br/><span class="hl-2">  </span><span class="hl-5">autostart:</span><span class="hl-2"> </span><span class="hl-6">false</span><span class="hl-2">, </span><span class="hl-0">// Do not start automatically</span><br/><span class="hl-2">  </span><span class="hl-5">processingInterval:</span><span class="hl-2"> </span><span class="hl-9">1000</span><span class="hl-2">, </span><span class="hl-0">// Process jobs every 1 second</span><br/><span class="hl-2">  </span><span class="hl-5">waitingInterval:</span><span class="hl-2"> </span><span class="hl-9">2000</span><span class="hl-2">, </span><span class="hl-0">// Check for new jobs every 2 seconds</span><br/><span class="hl-2">  </span><span class="hl-5">maxRetries:</span><span class="hl-2"> </span><span class="hl-9">5</span><span class="hl-2">, </span><span class="hl-0">// Retry failed jobs up to 5 times</span><br/><span class="hl-2">  </span><span class="hl-5">retryInterval:</span><span class="hl-2"> </span><span class="hl-9">1000</span><span class="hl-2">, </span><span class="hl-0">// Wait 1 second between retries</span><br/><span class="hl-2">})</span>
</code><button>Copy</button></pre>
</li>
</ul>
<p>These options allow you to tailor the behavior of queues and workers to fit your specific requirements.</p>
<a id="md:queue-and-worker-events" class="tsd-anchor"></a><h2><a href="#md:queue-and-worker-events">Queue and Worker Events</a></h2><p><code>@racunis/postgresql</code> supports various events for job queues and workers to handle job states and errors effectively. Below is an overview of the events and how you can use them.</p>
<a id="md:queue-events" class="tsd-anchor"></a><h3><a href="#md:queue-events">Queue Events</a></h3><p>These events are triggered by the queue during different stages of job processing.</p>
<ul>
<li><strong>activated</strong>: Emitted when a job is activated.</li>
<li><strong>completed</strong>: Emitted when a job is completed.</li>
<li><strong>failed</strong>: Emitted when a job fails.</li>
<li><strong>error</strong>: Emitted when an error occurs.</li>
</ul>
<pre><code class="language-typescript"><span class="hl-4">import</span><span class="hl-2"> { </span><span class="hl-5">PostgreSqlQueue</span><span class="hl-2"> } </span><span class="hl-4">from</span><span class="hl-2"> </span><span class="hl-3">&#39;@racunis/postgresql&#39;</span><br/><span class="hl-4">import</span><span class="hl-2"> </span><span class="hl-4">type</span><span class="hl-2"> { </span><span class="hl-5">Job</span><span class="hl-2"> } </span><span class="hl-4">from</span><span class="hl-2"> </span><span class="hl-3">&#39;@racunis/core&#39;</span><br/><br/><span class="hl-6">interface</span><span class="hl-2"> </span><span class="hl-7">JobPayload</span><span class="hl-2"> {</span><br/><span class="hl-2">  </span><span class="hl-5">type</span><span class="hl-2">: </span><span class="hl-7">string</span><br/><span class="hl-2">  </span><span class="hl-5">details</span><span class="hl-2">: </span><span class="hl-7">any</span><br/><span class="hl-2">}</span><br/><br/><span class="hl-6">const</span><span class="hl-2"> </span><span class="hl-1">main</span><span class="hl-2"> = </span><span class="hl-6">async</span><span class="hl-2"> () </span><span class="hl-6">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">  </span><span class="hl-0">// Create the queue</span><br/><span class="hl-2">  </span><span class="hl-6">const</span><span class="hl-2"> </span><span class="hl-8">queue</span><span class="hl-2"> = </span><span class="hl-4">await</span><span class="hl-2"> </span><span class="hl-5">PostgreSqlQueue</span><span class="hl-2">.</span><span class="hl-1">create</span><span class="hl-2">&lt;</span><span class="hl-7">JobPayload</span><span class="hl-2">&gt;(</span><span class="hl-3">&#39;Queue&#39;</span><span class="hl-2">, {</span><br/><span class="hl-2">    </span><span class="hl-5">connectionString:</span><span class="hl-2"> </span><span class="hl-3">&#39;postgresql://user:password@localhost:port/db&#39;</span><span class="hl-2">,</span><br/><span class="hl-2">  })</span><br/><br/><span class="hl-2">  </span><span class="hl-0">// Event listener for when a job is activated</span><br/><span class="hl-2">  </span><span class="hl-5">queue</span><span class="hl-2">.</span><span class="hl-1">on</span><span class="hl-2">(</span><span class="hl-3">&#39;activated&#39;</span><span class="hl-2">, ({ </span><span class="hl-5">job</span><span class="hl-2"> }) </span><span class="hl-6">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">    </span><span class="hl-5">console</span><span class="hl-2">.</span><span class="hl-1">log</span><span class="hl-2">(</span><span class="hl-3">`Job activated: </span><span class="hl-6">${</span><span class="hl-5">job</span><span class="hl-10">.</span><span class="hl-5">id</span><span class="hl-6">}</span><span class="hl-3">`</span><span class="hl-2">)</span><br/><span class="hl-2">  })</span><br/><br/><span class="hl-2">  </span><span class="hl-0">// Event listener for when a job is completed</span><br/><span class="hl-2">  </span><span class="hl-5">queue</span><span class="hl-2">.</span><span class="hl-1">on</span><span class="hl-2">(</span><span class="hl-3">&#39;completed&#39;</span><span class="hl-2">, ({ </span><span class="hl-5">job</span><span class="hl-2"> }) </span><span class="hl-6">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">    </span><span class="hl-5">console</span><span class="hl-2">.</span><span class="hl-1">log</span><span class="hl-2">(</span><span class="hl-3">`Job completed: </span><span class="hl-6">${</span><span class="hl-5">job</span><span class="hl-10">.</span><span class="hl-5">id</span><span class="hl-6">}</span><span class="hl-3">`</span><span class="hl-2">)</span><br/><span class="hl-2">  })</span><br/><br/><span class="hl-2">  </span><span class="hl-0">// Event listener for when a job fails</span><br/><span class="hl-2">  </span><span class="hl-5">queue</span><span class="hl-2">.</span><span class="hl-1">on</span><span class="hl-2">(</span><span class="hl-3">&#39;failed&#39;</span><span class="hl-2">, ({ </span><span class="hl-5">job</span><span class="hl-2">, </span><span class="hl-5">error</span><span class="hl-2"> }) </span><span class="hl-6">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">    </span><span class="hl-5">console</span><span class="hl-2">.</span><span class="hl-1">log</span><span class="hl-2">(</span><span class="hl-3">`Job failed: </span><span class="hl-6">${</span><span class="hl-5">job</span><span class="hl-10">.</span><span class="hl-5">id</span><span class="hl-6">}</span><span class="hl-3">, Error: </span><span class="hl-6">${</span><span class="hl-5">error</span><span class="hl-10">.</span><span class="hl-5">message</span><span class="hl-6">}</span><span class="hl-3">`</span><span class="hl-2">)</span><br/><span class="hl-2">  })</span><br/><br/><span class="hl-2">  </span><span class="hl-0">// Event listener for queue errors</span><br/><span class="hl-2">  </span><span class="hl-5">queue</span><span class="hl-2">.</span><span class="hl-1">on</span><span class="hl-2">(</span><span class="hl-3">&#39;error&#39;</span><span class="hl-2">, ({ </span><span class="hl-5">error</span><span class="hl-2"> }) </span><span class="hl-6">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">    </span><span class="hl-5">console</span><span class="hl-2">.</span><span class="hl-1">error</span><span class="hl-2">(</span><span class="hl-3">`Queue error: </span><span class="hl-6">${</span><span class="hl-5">error</span><span class="hl-10">.</span><span class="hl-5">message</span><span class="hl-6">}</span><span class="hl-3">`</span><span class="hl-2">)</span><br/><span class="hl-2">  })</span><br/><br/><span class="hl-2">  </span><span class="hl-0">// Add jobs to the queue</span><br/><span class="hl-2">  </span><span class="hl-4">await</span><span class="hl-2"> </span><span class="hl-5">queue</span><span class="hl-2">.</span><span class="hl-1">add</span><span class="hl-2">({ </span><span class="hl-5">type:</span><span class="hl-2"> </span><span class="hl-3">&#39;EmailProcessing&#39;</span><span class="hl-2">, </span><span class="hl-5">details:</span><span class="hl-2"> { </span><span class="hl-5">recipient:</span><span class="hl-2"> </span><span class="hl-3">&#39;user@example.com&#39;</span><span class="hl-2">, </span><span class="hl-5">content:</span><span class="hl-2"> </span><span class="hl-3">&#39;Hello, World!&#39;</span><span class="hl-2"> } }, </span><span class="hl-9">5</span><span class="hl-2">)</span><br/><span class="hl-2">}</span><br/><br/><span class="hl-4">try</span><span class="hl-2"> {</span><br/><span class="hl-2">  </span><span class="hl-4">await</span><span class="hl-2"> </span><span class="hl-1">main</span><span class="hl-2">()</span><br/><span class="hl-2">}</span><br/><span class="hl-4">catch</span><span class="hl-2"> (</span><span class="hl-5">error</span><span class="hl-2">) {</span><br/><span class="hl-2">  </span><span class="hl-5">console</span><span class="hl-2">.</span><span class="hl-1">error</span><span class="hl-2">(</span><span class="hl-5">error</span><span class="hl-2">)</span><br/><span class="hl-2">}</span>
</code><button>Copy</button></pre>
<a id="md:worker-events" class="tsd-anchor"></a><h3><a href="#md:worker-events">Worker Events</a></h3><p>These events are triggered by the worker while processing jobs.</p>
<ul>
<li><strong>waiting</strong>: Emitted when the worker is waiting for a job.</li>
<li><strong>activated</strong>: Emitted when a job is activated.</li>
<li><strong>completed</strong>: Emitted when a job is completed.</li>
<li><strong>failed</strong>: Emitted when a job fails.</li>
</ul>
<pre><code class="language-typescript"><span class="hl-4">import</span><span class="hl-2"> { </span><span class="hl-5">PostgreSqlQueue</span><span class="hl-2">, </span><span class="hl-5">PostgreSqlWorker</span><span class="hl-2"> } </span><span class="hl-4">from</span><span class="hl-2"> </span><span class="hl-3">&#39;@racunis/postgresql&#39;</span><br/><span class="hl-4">import</span><span class="hl-2"> </span><span class="hl-4">type</span><span class="hl-2"> { </span><span class="hl-5">Job</span><span class="hl-2"> } </span><span class="hl-4">from</span><span class="hl-2"> </span><span class="hl-3">&#39;@racunis/core&#39;</span><br/><br/><span class="hl-6">interface</span><span class="hl-2"> </span><span class="hl-7">JobPayload</span><span class="hl-2"> {</span><br/><span class="hl-2">  </span><span class="hl-5">type</span><span class="hl-2">: </span><span class="hl-7">string</span><br/><span class="hl-2">  </span><span class="hl-5">details</span><span class="hl-2">: </span><span class="hl-7">any</span><br/><span class="hl-2">}</span><br/><br/><span class="hl-6">const</span><span class="hl-2"> </span><span class="hl-1">main</span><span class="hl-2"> = </span><span class="hl-6">async</span><span class="hl-2"> () </span><span class="hl-6">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">  </span><span class="hl-0">// Create the queue</span><br/><span class="hl-2">  </span><span class="hl-6">const</span><span class="hl-2"> </span><span class="hl-8">queue</span><span class="hl-2"> = </span><span class="hl-4">await</span><span class="hl-2"> </span><span class="hl-5">PostgreSqlQueue</span><span class="hl-2">.</span><span class="hl-1">create</span><span class="hl-2">&lt;</span><span class="hl-7">JobPayload</span><span class="hl-2">&gt;(</span><span class="hl-3">&#39;Queue&#39;</span><span class="hl-2">, {</span><br/><span class="hl-2">    </span><span class="hl-5">connectionString:</span><span class="hl-2"> </span><span class="hl-3">&#39;postgresql://user:password@localhost:port/db&#39;</span><span class="hl-2">,</span><br/><span class="hl-2">  })</span><br/><br/><span class="hl-2">  </span><span class="hl-0">// Create a worker to process jobs from the queue</span><br/><span class="hl-2">  </span><span class="hl-6">const</span><span class="hl-2"> </span><span class="hl-8">worker</span><span class="hl-2"> = </span><span class="hl-5">PostgreSqlWorker</span><span class="hl-2">.</span><span class="hl-1">create</span><span class="hl-2">(</span><span class="hl-5">queue</span><span class="hl-2">, (</span><span class="hl-5">job</span><span class="hl-2">) </span><span class="hl-6">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">    </span><span class="hl-6">const</span><span class="hl-2"> { </span><span class="hl-8">type</span><span class="hl-2">, </span><span class="hl-8">details</span><span class="hl-2"> } = </span><span class="hl-5">job</span><span class="hl-2">.</span><span class="hl-5">payload</span><br/><span class="hl-2">    </span><span class="hl-4">switch</span><span class="hl-2"> (</span><span class="hl-5">type</span><span class="hl-2">) {</span><br/><span class="hl-2">      </span><span class="hl-4">case</span><span class="hl-2"> </span><span class="hl-3">&#39;EmailProcessing&#39;</span><span class="hl-2">:</span><br/><span class="hl-2">        </span><span class="hl-5">console</span><span class="hl-2">.</span><span class="hl-1">log</span><span class="hl-2">(</span><span class="hl-3">`Processing Email Job: Recipient - </span><span class="hl-6">${</span><span class="hl-5">details</span><span class="hl-10">.</span><span class="hl-5">recipient</span><span class="hl-6">}</span><span class="hl-3">, Content - </span><span class="hl-6">${</span><span class="hl-5">details</span><span class="hl-10">.</span><span class="hl-5">content</span><span class="hl-6">}</span><span class="hl-3">`</span><span class="hl-2">)</span><br/><span class="hl-2">        </span><span class="hl-4">break</span><br/><span class="hl-2">      </span><span class="hl-4">case</span><span class="hl-2"> </span><span class="hl-3">&#39;DataMigration&#39;</span><span class="hl-2">:</span><br/><span class="hl-2">        </span><span class="hl-5">console</span><span class="hl-2">.</span><span class="hl-1">log</span><span class="hl-2">(</span><span class="hl-3">`Processing Data Migration Job: Source - </span><span class="hl-6">${</span><span class="hl-5">details</span><span class="hl-10">.</span><span class="hl-5">source</span><span class="hl-6">}</span><span class="hl-3">, Destination - </span><span class="hl-6">${</span><span class="hl-5">details</span><span class="hl-10">.</span><span class="hl-5">destination</span><span class="hl-6">}</span><span class="hl-3">`</span><span class="hl-2">)</span><br/><span class="hl-2">        </span><span class="hl-4">break</span><br/><span class="hl-2">      </span><span class="hl-4">case</span><span class="hl-2"> </span><span class="hl-3">&#39;ReportGeneration&#39;</span><span class="hl-2">:</span><br/><span class="hl-2">        </span><span class="hl-5">console</span><span class="hl-2">.</span><span class="hl-1">log</span><span class="hl-2">(</span><span class="hl-3">`Processing Report Generation Job: Report ID - </span><span class="hl-6">${</span><span class="hl-5">details</span><span class="hl-10">.</span><span class="hl-5">reportId</span><span class="hl-6">}</span><span class="hl-3">, Requested By - </span><span class="hl-6">${</span><span class="hl-5">details</span><span class="hl-10">.</span><span class="hl-5">requestedBy</span><span class="hl-6">}</span><span class="hl-3">`</span><span class="hl-2">)</span><br/><span class="hl-2">        </span><span class="hl-4">break</span><br/><span class="hl-2">    }</span><br/><span class="hl-2">  }, { </span><span class="hl-5">autostart:</span><span class="hl-2"> </span><span class="hl-6">false</span><span class="hl-2"> })</span><br/><br/><span class="hl-2">  </span><span class="hl-0">// Event listener for when the worker is waiting for a job</span><br/><span class="hl-2">  </span><span class="hl-5">worker</span><span class="hl-2">.</span><span class="hl-1">on</span><span class="hl-2">(</span><span class="hl-3">&#39;waiting&#39;</span><span class="hl-2">, () </span><span class="hl-6">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">    </span><span class="hl-5">console</span><span class="hl-2">.</span><span class="hl-1">log</span><span class="hl-2">(</span><span class="hl-3">&#39;Worker is waiting for a job...&#39;</span><span class="hl-2">)</span><br/><span class="hl-2">  })</span><br/><br/><span class="hl-2">  </span><span class="hl-0">// Event listener for when a job is activated</span><br/><span class="hl-2">  </span><span class="hl-5">worker</span><span class="hl-2">.</span><span class="hl-1">on</span><span class="hl-2">(</span><span class="hl-3">&#39;activated&#39;</span><span class="hl-2">, ({ </span><span class="hl-5">job</span><span class="hl-2"> }) </span><span class="hl-6">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">    </span><span class="hl-5">console</span><span class="hl-2">.</span><span class="hl-1">log</span><span class="hl-2">(</span><span class="hl-3">`Job activated: </span><span class="hl-6">${</span><span class="hl-5">job</span><span class="hl-10">.</span><span class="hl-5">id</span><span class="hl-6">}</span><span class="hl-3">`</span><span class="hl-2">)</span><br/><span class="hl-2">  })</span><br/><br/><span class="hl-2">  </span><span class="hl-0">// Event listener for when a job is completed</span><br/><span class="hl-2">  </span><span class="hl-5">worker</span><span class="hl-2">.</span><span class="hl-1">on</span><span class="hl-2">(</span><span class="hl-3">&#39;completed&#39;</span><span class="hl-2">, ({ </span><span class="hl-5">job</span><span class="hl-2"> }) </span><span class="hl-6">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">    </span><span class="hl-5">console</span><span class="hl-2">.</span><span class="hl-1">log</span><span class="hl-2">(</span><span class="hl-3">`Job completed: </span><span class="hl-6">${</span><span class="hl-5">job</span><span class="hl-10">.</span><span class="hl-5">id</span><span class="hl-6">}</span><span class="hl-3">`</span><span class="hl-2">)</span><br/><span class="hl-2">  })</span><br/><br/><span class="hl-2">  </span><span class="hl-0">// Event listener for when a job fails</span><br/><span class="hl-2">  </span><span class="hl-5">worker</span><span class="hl-2">.</span><span class="hl-1">on</span><span class="hl-2">(</span><span class="hl-3">&#39;failed&#39;</span><span class="hl-2">, ({ </span><span class="hl-5">job</span><span class="hl-2">, </span><span class="hl-5">error</span><span class="hl-2"> }) </span><span class="hl-6">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">    </span><span class="hl-5">console</span><span class="hl-2">.</span><span class="hl-1">log</span><span class="hl-2">(</span><span class="hl-3">`Job failed: </span><span class="hl-6">${</span><span class="hl-5">job</span><span class="hl-10">.</span><span class="hl-5">id</span><span class="hl-6">}</span><span class="hl-3">, Error: </span><span class="hl-6">${</span><span class="hl-5">error</span><span class="hl-10">.</span><span class="hl-5">message</span><span class="hl-6">}</span><span class="hl-3">`</span><span class="hl-2">)</span><br/><span class="hl-2">  })</span><br/><br/><span class="hl-2">  </span><span class="hl-0">// Start the worker</span><br/><span class="hl-2">  </span><span class="hl-5">worker</span><span class="hl-2">.</span><span class="hl-1">start</span><span class="hl-2">()</span><br/><span class="hl-2">}</span><br/><br/><span class="hl-4">try</span><span class="hl-2"> {</span><br/><span class="hl-2">  </span><span class="hl-4">await</span><span class="hl-2"> </span><span class="hl-1">main</span><span class="hl-2">()</span><br/><span class="hl-2">}</span><br/><span class="hl-4">catch</span><span class="hl-2"> (</span><span class="hl-5">error</span><span class="hl-2">) {</span><br/><span class="hl-2">  </span><span class="hl-5">console</span><span class="hl-2">.</span><span class="hl-1">error</span><span class="hl-2">(</span><span class="hl-5">error</span><span class="hl-2">)</span><br/><span class="hl-2">}</span>
</code><button>Copy</button></pre>
<a id="md:queue-and-worker-control" class="tsd-anchor"></a><h3><a href="#md:queue-and-worker-control">Queue and Worker Control</a></h3><p><code>@racunis/postgresql</code> provides mechanisms to control the execution of queues and workers, as well as methods to manage the state of jobs in the queue.</p>
<a id="md:getting-job-counts" class="tsd-anchor"></a><h4><a href="#md:getting-job-counts">Getting Job Counts</a></h4><p>You can get the count of jobs in various states using the <code>getJobCounts</code> method. This is useful for monitoring and managing the state of your job queue.</p>
<pre><code class="language-typescript"><span class="hl-6">const</span><span class="hl-2"> </span><span class="hl-8">jobCounts</span><span class="hl-2"> = </span><span class="hl-4">await</span><span class="hl-2"> </span><span class="hl-5">queue</span><span class="hl-2">.</span><span class="hl-1">getJobCounts</span><span class="hl-2">(</span><span class="hl-3">&#39;waiting&#39;</span><span class="hl-2">, </span><span class="hl-3">&#39;active&#39;</span><span class="hl-2">, </span><span class="hl-3">&#39;completed&#39;</span><span class="hl-2">, </span><span class="hl-3">&#39;failed&#39;</span><span class="hl-2">)</span><br/><span class="hl-5">console</span><span class="hl-2">.</span><span class="hl-1">log</span><span class="hl-2">(</span><span class="hl-3">`Waiting: </span><span class="hl-6">${</span><span class="hl-5">jobCounts</span><span class="hl-10">.</span><span class="hl-5">waiting</span><span class="hl-6">}</span><span class="hl-3">`</span><span class="hl-2">)</span><br/><span class="hl-5">console</span><span class="hl-2">.</span><span class="hl-1">log</span><span class="hl-2">(</span><span class="hl-3">`Active: </span><span class="hl-6">${</span><span class="hl-5">jobCounts</span><span class="hl-10">.</span><span class="hl-5">active</span><span class="hl-6">}</span><span class="hl-3">`</span><span class="hl-2">)</span><br/><span class="hl-5">console</span><span class="hl-2">.</span><span class="hl-1">log</span><span class="hl-2">(</span><span class="hl-3">`Completed: </span><span class="hl-6">${</span><span class="hl-5">jobCounts</span><span class="hl-10">.</span><span class="hl-5">completed</span><span class="hl-6">}</span><span class="hl-3">`</span><span class="hl-2">)</span><br/><span class="hl-5">console</span><span class="hl-2">.</span><span class="hl-1">log</span><span class="hl-2">(</span><span class="hl-3">`Failed: </span><span class="hl-6">${</span><span class="hl-5">jobCounts</span><span class="hl-10">.</span><span class="hl-5">failed</span><span class="hl-6">}</span><span class="hl-3">`</span><span class="hl-2">)</span>
</code><button>Copy</button></pre>
<p>This will give you an object with the counts of jobs in the specified states, helping you keep track of the queue&#39;s status.</p>
<a id="md:starting-and-stopping-queues-and-workers" class="tsd-anchor"></a><h4><a href="#md:starting-and-stopping-queues-and-workers">Starting and Stopping Queues and Workers</a></h4><p>You can start and stop job processing in queues and workers using the <code>start</code> and <code>stop</code> methods.</p>
<ul>
<li><p><strong>Queue Start/Stop</strong>: Use <code>start()</code> to begin processing jobs in the queue and <code>stop()</code> to halt job processing.</p>
<pre><code class="language-typescript"><span class="hl-4">await</span><span class="hl-2"> </span><span class="hl-5">queue</span><span class="hl-2">.</span><span class="hl-1">start</span><span class="hl-2">() </span><span class="hl-0">// Start processing jobs</span><br/><span class="hl-4">await</span><span class="hl-2"> </span><span class="hl-5">queue</span><span class="hl-2">.</span><span class="hl-1">stop</span><span class="hl-2">()  </span><span class="hl-0">// Stop processing jobs</span>
</code><button>Copy</button></pre>
</li>
<li><p><strong>Worker Start/Stop</strong>: Use <code>start()</code> to begin job processing by the worker and <code>stop()</code> to halt job processing.</p>
<pre><code class="language-typescript"><span class="hl-5">worker</span><span class="hl-2">.</span><span class="hl-1">start</span><span class="hl-2">() </span><span class="hl-0">// Start the worker</span><br/><span class="hl-4">await</span><span class="hl-2"> </span><span class="hl-5">worker</span><span class="hl-2">.</span><span class="hl-1">stop</span><span class="hl-2">() </span><span class="hl-0">// Stop the worker</span>
</code><button>Copy</button></pre>
</li>
</ul>
<p>If you attempt to start a worker on a stopped queue, the worker will not start. Conversely, if you restart a queue that has a previously stopped worker, the worker will automatically start processing jobs again.</p>
<a id="md:draining-and-emptying-the-queue" class="tsd-anchor"></a><h4><a href="#md:draining-and-emptying-the-queue">Draining and Emptying the Queue</a></h4><p><code>@racunis/postgresql</code> provides methods to manage the jobs in the queue:</p>
<ul>
<li><p><strong><code>drain()</code></strong>: Deletes all waiting jobs in the queue.</p>
<pre><code class="language-typescript"><span class="hl-4">await</span><span class="hl-2"> </span><span class="hl-5">queue</span><span class="hl-2">.</span><span class="hl-1">drain</span><span class="hl-2">() </span><span class="hl-0">// Clear all waiting jobs</span>
</code><button>Copy</button></pre>
</li>
<li><p><strong><code>empty()</code></strong>: Deletes all jobs in all states (waiting, active, completed, and failed).</p>
<pre><code class="language-typescript"><span class="hl-4">await</span><span class="hl-2"> </span><span class="hl-5">queue</span><span class="hl-2">.</span><span class="hl-1">empty</span><span class="hl-2">() </span><span class="hl-0">// Clear all jobs in the queue</span>
</code><button>Copy</button></pre>
</li>
</ul>
<p>These methods allow you to maintain control over the job queue, ensuring you can clear jobs as needed.</p>
<a id="md:closing-the-queue" class="tsd-anchor"></a><h4><a href="#md:closing-the-queue">Closing the Queue</a></h4><p>The close method allows you to close the queue and release all associated resources. This is particularly useful for clean-up operations and ensuring that all connections are properly terminated.</p>
<pre><code class="language-typescript"><span class="hl-4">await</span><span class="hl-2"> </span><span class="hl-5">queue</span><span class="hl-2">.</span><span class="hl-1">close</span><span class="hl-2">() </span><span class="hl-0">// Close the queue and release resources</span>
</code><button>Copy</button></pre>
<p>This method stops the queue from processing jobs, closes all associated workers, and releases any resources used by the queue, such as database connections.</p>
<a id="md:contributing" class="tsd-anchor"></a><h2><a href="#md:contributing">Contributing</a></h2><p>I appreciate your interest in contributing! Please see the <a href="https://github.com/mrcointreau/racunis/blob/main/CONTRIBUTING.md">CONTRIBUTING.md</a> file for guidelines on how to contribute.</p>
<a id="md:license" class="tsd-anchor"></a><h2><a href="#md:license">License</a></h2><p><code>@racunis/core</code> is licensed under the MIT License. See the <a href="https://github.com/mrcointreau/racunis/blob/main/LICENSE">LICENSE</a> file for more details.</p>
</section><section class="tsd-panel-group tsd-index-group"><section class="tsd-panel tsd-index-panel"><h3 class="tsd-index-heading uppercase">Index</h3><section class="tsd-index-section"><h3 class="tsd-index-heading">Classes</h3><div class="tsd-index-list"><a href="../classes/_racunis_postgresql.PostgreSqlQueue.html" class="tsd-index-link"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-128"></use></svg><span>Postgre<wbr/>Sql<wbr/>Queue</span></a>
<a href="../classes/_racunis_postgresql.PostgreSqlWorker.html" class="tsd-index-link"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-128"></use></svg><span>Postgre<wbr/>Sql<wbr/>Worker</span></a>
</div></section></section></section></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-index-accordion"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><h4 class="uppercase">Member Visibility</h4><form><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-private" name="private"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Private</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></form></div><div class="tsd-theme-toggle"><h4 class="uppercase">Theme</h4><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-index-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#md:racunispostgresql"><span>@racunis/postgresql</span></a><ul><li><a href="#md:features"><span>Features</span></a></li><li><a href="#md:usage"><span>Usage</span></a></li><li><ul><li><a href="#md:example"><span>Example</span></a></li><li><a href="#md:handling-multiple-job-types"><span>Handling <wbr/>Multiple <wbr/>Job <wbr/>Types</span></a></li></ul></li><li><a href="#md:queue-and-worker-options"><span>Queue and <wbr/>Worker <wbr/>Options</span></a></li><li><ul><li><a href="#md:queue-options"><span>Queue <wbr/>Options</span></a></li><li><a href="#md:worker-options"><span>Worker <wbr/>Options</span></a></li></ul></li><li><a href="#md:queue-and-worker-events"><span>Queue and <wbr/>Worker <wbr/>Events</span></a></li><li><ul><li><a href="#md:queue-events"><span>Queue <wbr/>Events</span></a></li><li><a href="#md:worker-events"><span>Worker <wbr/>Events</span></a></li><li><a href="#md:queue-and-worker-control"><span>Queue and <wbr/>Worker <wbr/>Control</span></a></li><li><ul><li><a href="#md:getting-job-counts"><span>Getting <wbr/>Job <wbr/>Counts</span></a></li><li><a href="#md:starting-and-stopping-queues-and-workers"><span>Starting and <wbr/>Stopping <wbr/>Queues and <wbr/>Workers</span></a></li><li><a href="#md:draining-and-emptying-the-queue"><span>Draining and <wbr/>Emptying the <wbr/>Queue</span></a></li><li><a href="#md:closing-the-queue"><span>Closing the <wbr/>Queue</span></a></li></ul></li></ul></li><li><a href="#md:contributing"><span>Contributing</span></a></li><li><a href="#md:license"><span>License</span></a></li></ul></div></details></div><div class="site-menu"><nav class="tsd-navigation"><a href="../index.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-1"></use></svg><span>Racunis</span></a><ul class="tsd-small-nested-navigation" id="tsd-nav-container" data-base=".."><li>Loading...</li></ul></nav></div></div></div><footer><p class="tsd-generator">Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a><br>
            <span id="generation-date"></span>
            <script>
                window.GENERATION_DATE = 1716197207900;

                (() => {
                    
        const formatter = new Intl.RelativeTimeFormat('en', {
            numeric: 'auto',
            style: 'short',
        });

        const divisions = [
            { amount: 60, name: 'seconds' },
            { amount: 60, name: 'minutes' },
            { amount: 24, name: 'hours' },
            { amount: 7, name: 'days' },
            { amount: 4.34524, name: 'weeks' },
            { amount: 12, name: 'months' },
            { amount: Number.POSITIVE_INFINITY, name: 'years' }
        ];

        function formatTimeAgo(date) {
            let duration = (date - new Date()) / 1000;
            
            for (const division of divisions) {
                if (Math.abs(duration) < division.amount) {
                    return formatter.format(Math.round(duration), division.name);
                }
                duration /= division.amount;
            }
        }

        document.getElementById('generation-date').title = new Date(window.GENERATION_DATE).toLocaleString();
        document.getElementById('generation-date').innerText = `Last modified ${formatTimeAgo(window.GENERATION_DATE)}`;
    
                })();
            </script>
        </p></footer><div class="overlay"></div></body></html>